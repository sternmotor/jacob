#drbd.conf
global {
    # max number of drbd devices
    minor-count 100;
    # dialog-refresh 5; # 5 seconds
    # disable-ip-verification;
    usage-count no;
}

common {
  syncer { rate 50M; }
  protocol C;

  startup {
    wfc-timeout         0;  ## Infinite!
    degr-wfc-timeout  120;  ## 2 minutes.
  }

  disk {
    on-io-error detach;
  }

  net {
    # timeout           60;
    # connect-int       10;
    # ping-int          10;
    # max-buffers     2048;
    # max-epoch-size  2048;
    cram-hmac-alg "sha1";
    shared-secret "shared_secret_key_for_drbd";
    allow-two-primaries;
  }
}


# sync host2 <=> host3
# gate
resource gate-root { 
    on host3 { device "/dev/drbd30" ; disk "/dev/vg0/gate-root"; address 10.98.102.130:7830; meta-disk internal; }
    on host2 { device "/dev/drbd30" ; disk "/dev/vg0/gate-root"; address 10.98.102.120:7830; meta-disk internal; }
}
resource gate-var { syncer { after "gate-root";  }
    on host3 { device "/dev/drbd31" ; disk "/dev/vg0/gate-var"; address 10.98.102.130:7831; meta-disk internal; }
    on host2 { device "/dev/drbd31" ; disk "/dev/vg0/gate-var"; address 10.98.102.120:7831; meta-disk internal; }
}
resource gate-tmp { syncer { after "gate-var";  }
    on host3 { device "/dev/drbd32" ; disk "/dev/vg0/gate-tmp"; address 10.98.102.130:7832; meta-disk internal; }
    on host2 { device "/dev/drbd32" ; disk "/dev/vg0/gate-tmp"; address 10.98.102.120:7832; meta-disk internal; }
}
resource gate-usr { syncer { after "gate-tmp";  }
    on host3 { device "/dev/drbd33" ; disk "/dev/vg0/gate-usr"; address 10.98.102.130:7833; meta-disk internal; }
    on host2 { device "/dev/drbd33" ; disk "/dev/vg0/gate-usr"; address 10.98.102.120:7833; meta-disk internal; }
}
#resource gate-srv { syncer { after "gate-usr";  }
#    on host3 { device "/dev/drbd34" ; disk "/dev/vg0/gate-srv"; address 10.98.102.130:7834; meta-disk internal; }
#    on host2 { device "/dev/drbd34" ; disk "/dev/vg0/gate-srv"; address 10.98.102.120:7834; meta-disk internal; }
#}
resource gate-swap { syncer { after "gate-usr";  }
    on host3 { device "/dev/drbd35" ; disk "/dev/vg0/gate-swap"; address 10.98.102.130:7835; meta-disk internal; }
    on host2 { device "/dev/drbd35" ; disk "/dev/vg0/gate-swap"; address 10.98.102.120:7835; meta-disk internal; }
}

#   # static
#   resource static-root { syncer { after "gate-swap";  }
#       on host3 { device "/dev/drbd40" ; disk "/dev/vg0/static-root"; address 10.98.102.130:7840; meta-disk internal; }
#       on host2 { device "/dev/drbd40" ; disk "/dev/vg0/static-root"; address 10.98.102.120:7840; meta-disk internal; }
#   }
#   resource static-var { syncer { after "static-root";  }
#       on host3 { device "/dev/drbd41" ; disk "/dev/vg0/static-var"; address 10.98.102.130:7841; meta-disk internal; }
#       on host2 { device "/dev/drbd41" ; disk "/dev/vg0/static-var"; address 10.98.102.120:7841; meta-disk internal; }
#   }
#   resource static-tmp { syncer { after "static-var";  }
#       on host3 { device "/dev/drbd42" ; disk "/dev/vg0/static-tmp"; address 10.98.102.130:7842; meta-disk internal; }
#       on host2 { device "/dev/drbd42" ; disk "/dev/vg0/static-tmp"; address 10.98.102.120:7842; meta-disk internal; }
#   }
#   resource static-usr { syncer { after "static-tmp";  }
#       on host3 { device "/dev/drbd43" ; disk "/dev/vg0/static-usr"; address 10.98.102.130:7843; meta-disk internal; }
#       on host2 { device "/dev/drbd43" ; disk "/dev/vg0/static-usr"; address 10.98.102.120:7843; meta-disk internal; }
#   }
#   resource static-srv { syncer { after "static-usr";  }
#       on host3 { device "/dev/drbd44" ; disk "/dev/vg0/static-srv"; address 10.98.102.130:7844; meta-disk internal; }
#       on host2 { device "/dev/drbd44" ; disk "/dev/vg0/static-srv"; address 10.98.102.120:7844; meta-disk internal; }
#   }
#   resource static-swap { syncer { after "static-srv";  }
#       on host3 { device "/dev/drbd45" ; disk "/dev/vg0/static-swap"; address 10.98.102.130:7845; meta-disk internal; }
#       on host2 { device "/dev/drbd45" ; disk "/dev/vg0/static-swap"; address 10.98.102.120:7845; meta-disk internal; }
#   }


# bomb
resource bomb-root { syncer { after "gate-swap";  }
    on host3 { device "/dev/drbd50" ; disk "/dev/vg0/bomb-root"; address 10.98.102.130:7850; meta-disk internal; }
    on host2 { device "/dev/drbd50" ; disk "/dev/vg0/bomb-root"; address 10.98.102.120:7850; meta-disk internal; }
}
resource bomb-var { syncer { after "bomb-root";  }
    on host3 { device "/dev/drbd51" ; disk "/dev/vg0/bomb-var"; address 10.98.102.130:7851; meta-disk internal; }
    on host2 { device "/dev/drbd51" ; disk "/dev/vg0/bomb-var"; address 10.98.102.120:7851; meta-disk internal; }
}
resource bomb-tmp { syncer { after "bomb-var";  }
    on host3 { device "/dev/drbd52" ; disk "/dev/vg0/bomb-tmp"; address 10.98.102.130:7852; meta-disk internal; }
    on host2 { device "/dev/drbd52" ; disk "/dev/vg0/bomb-tmp"; address 10.98.102.120:7852; meta-disk internal; }
}
resource bomb-usr { syncer { after "bomb-tmp";  }
    on host3 { device "/dev/drbd53" ; disk "/dev/vg0/bomb-usr"; address 10.98.102.130:7853; meta-disk internal; }
    on host2 { device "/dev/drbd53" ; disk "/dev/vg0/bomb-usr"; address 10.98.102.120:7853; meta-disk internal; }
}
resource bomb-srv { syncer { after "bomb-usr";  }
    on host3 { device "/dev/drbd54" ; disk "/dev/vg0/bomb-srv"; address 10.98.102.130:7854; meta-disk internal; }
    on host2 { device "/dev/drbd54" ; disk "/dev/vg0/bomb-srv"; address 10.98.102.120:7854; meta-disk internal; }
}
resource bomb-swap { syncer { after "bomb-srv";  }
   on host3 { device "/dev/drbd55" ; disk "/dev/vg0/bomb-swap"; address 10.98.102.130:7855; meta-disk internal; }
   on host2 { device "/dev/drbd55" ; disk "/dev/vg0/bomb-swap"; address 10.98.102.120:7855; meta-disk internal; }
}
# tomcat
resource tomcat-root { syncer { after "bomb-swap";  }
    on host3 { device "/dev/drbd60" ; disk "/dev/vg0/tomcat-root"; address 10.98.102.130:7860; meta-disk internal; }
    on host2 { device "/dev/drbd60" ; disk "/dev/vg0/tomcat-root"; address 10.98.102.120:7860; meta-disk internal; }
}
resource tomcat-var { syncer { after "tomcat-root";  }
    on host3 { device "/dev/drbd61" ; disk "/dev/vg0/tomcat-var"; address 10.98.102.130:7861; meta-disk internal; }
    on host2 { device "/dev/drbd61" ; disk "/dev/vg0/tomcat-var"; address 10.98.102.120:7861; meta-disk internal; }
}
resource tomcat-tmp { syncer { after "tomcat-var";  }
    on host3 { device "/dev/drbd62" ; disk "/dev/vg0/tomcat-tmp"; address 10.98.102.130:7862; meta-disk internal; }
    on host2 { device "/dev/drbd62" ; disk "/dev/vg0/tomcat-tmp"; address 10.98.102.120:7862; meta-disk internal; }
}
resource tomcat-usr { syncer { after "tomcat-tmp";  }
    on host3 { device "/dev/drbd63" ; disk "/dev/vg0/tomcat-usr"; address 10.98.102.130:7863; meta-disk internal; }
    on host2 { device "/dev/drbd63" ; disk "/dev/vg0/tomcat-usr"; address 10.98.102.120:7863; meta-disk internal; }
}
resource tomcat-srv { syncer { after "tomcat-usr";  }
    on host3 { device "/dev/drbd64" ; disk "/dev/vg0/tomcat-srv"; address 10.98.102.130:7864; meta-disk internal; }
    on host2 { device "/dev/drbd64" ; disk "/dev/vg0/tomcat-srv"; address 10.98.102.120:7864; meta-disk internal; }
}
resource tomcat-swap { syncer { after "tomcat-usr";  }
    on host3 { device "/dev/drbd65" ; disk "/dev/vg0/tomcat-swap"; address 10.98.102.130:7865; meta-disk internal; }
    on host2 { device "/dev/drbd65" ; disk "/dev/vg0/tomcat-swap"; address 10.98.102.120:7865; meta-disk internal; }
}
